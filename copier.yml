# ---------
#   Common
# ---------

project_id:
  type: str
  help: Name of the google project id
  validator: "{% if not project_id %}project_id is required{% endif %}"

gcp_user_account:
  type: str
  help: An email address that has google account permissions in the GCP project to give GCP resources permissions and will be used for letsencrypt certificates.
  validator: "{% if not gcp_user_account %}gcp_user_account is required{% endif %}"

state_bucket:
  type: str
  help: Name of GCP bucket to store terraform and terragrunt states. Must omit the gs:// prefix.
  validator: "{% if not state_bucket %}state_bucket is required{% elif 'gs://' in state_bucket %}Invalid format — omit gs://{% endif %}"

domain_name:
  type: str
  help: Base domain without protocols (e.g., example.org).
  validator: "{% if not domain_name %}domain_name is required{% endif %}"

region:
  type: str
  help: GCP region for regional resources (e.g., us-west1).
  validator: "{% if not region %}region is required{% endif %}"

zone:
  type: str
  help: GCP zone used in kube context and defaults (e.g., us-west1-b).
  validator: "{% if not zone %}zone is required{% endif %}"

owner:
  type: str
  help: "Text label used as prefix for computational resources; helpful for cost filtering."
  default: cave
  validator: "{% if not owner %}owner is required{% endif %}"

dns_zone:
  type: str
  help: "Cloud DNS managed zone name (e.g., em)."
  default: cave
  validator: "{% if not dns_zone %}dns_zone is required{% endif %}"

vpc_name_override:
  type: str
  help: Optional — existing VPC name to use instead of newly generated
  # TODO: Check the default handling in the template

docker_registry:
  type: str
  help: Container registry for images. The default docker.io/caveconnectome is likely correct.
  default: docker.io/caveconnectome
  validator: "{% if not docker_registry %}docker_registry is required{% endif %}"

# -------------
#   Local-Only
# -------------

local_environment_name:
  type: str
  help: Environment name used for the cluster folder (e.g., api, staging, prod). Default will work.
  default: api
  validator: "{% if not local_environment_name %}local_environment_name is required{% endif %}"

local_cluster_prefix:
  type: str
  help: Short identifier used as cluster_prefix and DNS subdomain (e.g. apiv1 for apiv1.example.com), you might have several versions of a cluster from one environment, suggest to be clearly related to the local_environment_name. Default will work.
  default: apiv1
  validator: "{% if not local_cluster_prefix %}local_cluster_prefix is required{% endif %}"

local_sql_instance_name:
  type: str
  help: "Cloud SQL Postgres instance name. If migrating existing data, lookup the name you have already used."
  default: "cave-{{ local_environment_name }}"
  validator: "{% if not local_sql_instance_name %}local_sql_instance_name is required{% endif %}"

global_server:
  type: str
  help: URL of the global cluster without protocols.
  default: "global.{{ domain_name }}"
  validator: "{% if not global_server %}global_server is required{% endif %}"

materialize_datastack:
  type: str
  help: The first datastack that you want to set up, and create a templated materialization schedule for.  You must supply answer, but is easy to change later.
  default: my_new_datastack
  validator: "{% if not materialize_datastack %}materialize_datastack is required{% endif %}"

pcg_bucket_name:
  type: str
  help: The name of the bucket you set up to store PyChunkedGraph data.
  validator: "{% if not pcg_bucket_name %}pcg_bucket_name is required{% endif %}"

health_annotation_align_volume:
  type: str
  help: An aligned volume name that will be used by the Annotation service for the liveliness probe
  validator: "{% if not health_annotation_align_volume %}health_annotation_align_volume is required{% endif %}"

bigtable_instance_name:
  type: str
  help: Bigtable instance name for PyChunkedGraph. Default is fine.
  default: pychunkedgraph
  validator: "{% if not bigtable_instance_name %}bigtable_instance_name is required{% endif %}"

cave_secret_name:
  type: str
  help: Name of the Google Secret Manager secret containing the CAVE token. Defaults to {{ local_environment_name }}-cave-token. You must manually create this secret before running terraform
  default: "{{ local_environment_name }}-cave-token"
  validator: "{% if not cave_secret_name %}cave_secret_name is required{% endif %}"

letsencrypt_email:
  type: str
  help: "Email for Let's Encrypt certificates. Defaults to your gcp_user_account value."
  default: "{{ gcp_user_account }}"
  validator: "{% if not letsencrypt_email %}letsencrypt_email is required{% endif %}"

pcg_redis_name_override:
  type: str
  help: "Optional: Name of redis instance to store PCG meshing cache data.  Default will name it based on cluster_prefix."
# TODO: Constructing the default could be put into this part of the template

bigtable_google_project:
  type: str
  help: "Optional: If your PCG bigtable instance is in another project, the name of that project. Otherwise leave blank."

skeleton_cache_cloudpath:
  type: str
  help: "Optional: if you have already setup a skeleton cache bucket, name of the path to that bucket. Note you need to uncomment this in the root.hcl file to utilize"
  validator: "{% if 'gs://' in skeleton_cache_cloudpath %}Invalid format — omit gs://{% endif %}"

pcg_skeleton_cache_bucket_public_read:
  type: bool
  help: "Optional: should the skeleton cache bucket be publicly readable. If true, you need to uncomment in the root.hcl file"
  default: false

materialization_dump_bucket_name:
  type: str
  help: "Optional: GCS bucket name for materialization dumps. Leave blank if not needed."
  validator: "{% if 'gs://' in materialization_dump_bucket_name %}Invalid format — omit gs://{% endif %}"
  # TODO: Double check bucket format, presumably without the gs.

materialization_upload_bucket_name:
  type: str
  help: "Optional: GCS bucket name for materialization uploads. Leave blank if not needed."
  validator: "{% if 'gs://' in materialization_upload_bucket_name %}Invalid format — omit gs://{% endif %}"
  # TODO: Double check bucket format, presumably without the gs.
    